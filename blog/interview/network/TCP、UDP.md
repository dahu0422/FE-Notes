# TCP

TCP 是一种面向连接的、可靠的、基于字节流的传输协议。通过三次握手建立连接，通过四次挥手终止连接。

TCP 是一种可靠的传输服务，保证了数据从源主机到目的主机的正确传输，主要有以下特点：

- 有序：保证数据按照发送的顺序到达
- 无损：确保所有发送数据都被正确无误地理解
- 流量控制：防止发送方发送速度过快，超出接收方处理能力
- 拥塞控制：防止过多的数据注入到网络中，引起网络拥塞

## 三次握手

TCP 三次握手是为了建立连接，防止数据包丢失和乱序。过程如下：

1. SYN（同步序列编号）：客户端想服务器发送一个 SYN（SYN = x） 包，同时包含一个初始化序列号 x，表示希望建立连接。
2. SYN-ACK（同步序列编号确认）：服务器收到 SYN 包后，向客户端发送一个 SYN-ACK 包（SYN = y, ACK = x + 1），其中 y 是服务器的初始化序列，x + 1 是对客户端序列号 x 的确认。
3. ACK（确认）：客户端收到服务器的 SYN-ACK 包后，向服务器发送一个 ACK 包（ACK = y + 1），表示已经收到了服务器的 SYN-ACK 包，此时连接建立成功。

## 四次挥手

四次挥手是 TCP 协议关闭连接的过程。因为 TCP 是双工的，所以每个方向上的连接关闭都需要单独处理。过程如下：

1. FIN（终止）：假设客户端想要关闭到服务端的方向上的连接，客户端发送一个 FIN 包（FIN = 1, 序列号 seq = u），表示数据发送完毕。
2. ACK：服务端接收到 FIN 包后，发送一个 ACK 包（ACK = 1, 序列号 seq = v, 确认号 ack = u+1），表示确认接收到 FIN 包。
3. FIN：一段时间后，服务端 也完成数据发送，向客户端发送一个 FIN 包（FIN = 1, 序列号 seq = w），表示服务端方向上的数据也发送完毕。
4. ACK：客户端接收到服务端的 FIN 包后，发送一个 ACK 包（ACK = 1, 序列号 seq = u+1, 确认号 ack = w+1），确认接收到服务端的 FIN 包。

两个方向上的连接都关闭后，整个 TCP 连接就被关闭了。需要注意的是，在最后一个 ACK 包发送后，还需要等待一个最长报文段寿命（Maximum Segment Lifetime, MSL）的时间，确保所有的数据都已经离开网络，然后才能完全关闭连接。

# UDP

UDP 是一种无连接的、不可靠的、基于数据包的传输层协议。主要特点：

- 无需建立连接：发送数据前不需要建立连接，只需要知道目的的地址和端口即可发送数据
- 无确认机制：发送方发送数据后不会等待确认，因此可能存在数据丢失情况
- 不保证顺序：UDP 不会对数据包进行排序，发送的数据可能是乱序到达的
- 低开销：没有复杂的握手和确认过程。

## 相关连接

- [CSDN 简单理解 TCP 三次握手四次挥手（看一遍你就懂）](https://blog.csdn.net/m0_56649557/article/details/119492899)
